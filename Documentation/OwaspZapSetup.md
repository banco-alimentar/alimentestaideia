# OWASP ZAP Introduction

Owasp Zap is one the most widely used open source web application scanner and penetration testing tool. It is available as a built in package on Kali linux and can be installed on windows, macOS and Linux. It is recommended to use OWASP ZAP on a Kali Linux VM on Azure as there may be IT restrictions to install a penetration testing tool on official laptop or Desktop. 

Further Reading:

1. [OWASP ZAP Official documentation](https://www.zaproxy.org/)
2. [OWASP ZAP Github](https://github.com/zaproxy)

# Setting up OWASP ZAP for penetration testing of alimentestaideia.pt

1. Refer [penetration testing](../Penetration-Test-Setup/Readme.MD) to setup your application for penetration testing on a kali linux VM.
2. XRDP to kali linux VM and start OWASP ZAP from Application--> Web Application Analysis --> OWASP ZAP.
3. Setup a proxy in your browser where you will open your web application, setup proxy to 127.0.0.1 and port as 8080 which ZAP uses as default.


# Performing Scan of the application

There are several concepts and options in ZAP to attack an application, the ones which we will be using for our application are:

1. Spider- The spider is a tool that is used to automatically discover new resources (URLs) on a particular Site. It begins with a list of URLs to visit, called the seeds, which depends on how the Spider is started. The Spider then visits these URLs, it identifies all the hyperlinks in the page and adds them to the list of URLs to visit and the process continues recursively as long as new resources are found.

3. Active Scan- Active scanning attempts to find potential vulnerabilities by using known attacks against the selected targets. Active scanning is an attack on those targets. You should NOT use it on web applications that you do not own, it is ILLEGAL.


5. Fuzz- Fuzzing is a technique of submitting lots of invalid or unexpected data to a target.
ZAP allows you to fuzz any request still using:

1.  A build in set of payloads
2.  Payloads defined by optional add-ons
3.  Custom scripts

# Steps for un-authenticated scan:

Unauthenticated scan means that Zap will scan and do intrusive attacks on the application acting like an un-authenticated user. 

Step 1: As a first step, context of the scan is defined. A context is the boundary of the scan, it can include URLs and domain names on which ZAP is allowed to attack, this is the most important part of penetration testing as chosing the right context will prevent attack on un-suspecting URLs and domain names. Login to your application and click on several places within the website to generate some. traffic for ZAP. Now, within the sites section, right click on your website and include it in default context.

Step 2: Start Spidering on your application by chosing the default context, notice that ZAP will find some issues. Check if these are valid issues my manually testing application.

Step 3: Start Active Scan on the application. You can also use fuzzing for trying to break into the application as an un-authenticated user, details on how to use fuzzing are here: [Fuzzing in OWASP ZAP](https://www.zaproxy.org/docs/desktop/addons/fuzzer/). You may like to do multiple iterations of active scan. by changing the payload of fuzzing.

# Steps for authenticated scan:

Step 1: Define context similar to un-authenticated user.

Step 2: Navigate to the login page of the website and add your credentials to login.

Step 3: Check that the URL has made its way to the context under sites section in ZAP, right click on login URL, select flag as context and add it as form based authentication. You may need to make some changes to the pop which gets shown to select the correct username and password parameters and identifiers to the login and logout page.

Step 4: Spider the application again as an autehenticated user.

Step 5: Start active scan by using fuzzing (optional)

More on Authenticated Scans here: [Zap Authenticated Scans](https://www.zaproxy.org/docs/desktop/start/features/authentication/)


# Reporting Vulnerabilities and Exploits

After every scan, ZAP lists out Alerts, a detailed HTML report based on alerts can be generated by navigating to Report-> "Generate HTML Report". This report will contain all details about the vulnerability and how ZAP exploited the vulnerability. 

